scale_fill_viridis_d()
barplot_tbl
barplot_tbl %>% filter(Dominant_Topic == 6)
barplot_tbl %>% filter(Dominant_Topic == 6) %>% pull(Other_Reactions) %>% sum()
barplot_tbl %>% filter(Dominant_Topic == 6, Interactions_Type == "Other_Reactions") %>% pull(Interactions_Count) %>% sum()
barplot_tbl %>% filter(Dominant_Topic == 6, Interactions_Type == "Comments") %>% pull(Interactions_Count) %>% sum()
barplot_tbl %>% filter(Dominant_Topic == 6, Interactions_Type == "Shares") %>% pull(Interactions_Count) %>% sum()
topic_engagement_tbl
topic_engagement_tbl %>%
pull(Dominant_Topic) %>%
table()
topic_engagement_tbl %>%
pull(Dominant_Topic) %>%
table() %>% sum()
topic_engagement_tbl
topic_engagement_tbl %>%
pull(Dominant_Topic) %>%
table() %>% as_tibble()
topic_engagement_tbl %>%
pull(Dominant_Topic) %>%
table() %>%
as_tibble() %>%
rename("Topic" = 1)
topic_engagement_tbl %>%
count(Dominant_Topic)
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n)
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity")
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="cyan")
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="black") +
theme_bw()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray") +
theme_bw()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray2") +
theme_bw()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray3") +
theme_bw()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray27") +
theme_bw()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray27", width = 0.1) +
theme_bw()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray27", width = 0.3) +
theme_bw()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray27", width = 0.4) +
theme_bw()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray27", width = 0.4) +
labs(x="Topic", y="Count", title="Frequency of topics")
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray27", width = 0.4) +
labs(x="Topic", y="Count", title="Frequency of topics") +
theme_bw()
topic_freq_tbl <- topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray27", width = 0.4) +
labs(x="Topic", y="Count", title="Frequency of topics") +
theme_bw()
ggsave(filename = "results/topic_freq.pdf", device = "pdf", width = 7, height = 5, units = "in")
pairwise_tbl <- read_csv("results/wilcoxon_test_holm.csv")
pairwise_tbl
pairwise_tbl %>% pull(p.adj.signif) %>% unique()
View(pairwise_tbl)
pairwise_tbl %>%
mutate(significance  = ifelse(p.adj.signif == "ns", 0,
ifelse(p.adj.signif == "*", 1,
ifelse(p.adj.signif == "**", 2,
ifelse(p.adj.signif == "***", 3, 4)))))
heatmap_tbl <- pairwise_tbl %>%
mutate(significance  = ifelse(p.adj.signif == "ns", 0,
ifelse(p.adj.signif == "*", 1,
ifelse(p.adj.signif == "**", 2,
ifelse(p.adj.signif == "***", 3, 4))))) %>%
select(group1, group2, significance)
heatmap_tbl
ggplot(heatmap_tbl, aes(group1, group2, fill= significance)) +
geom_tile()
ggplot(heatmap_tbl, aes(group1, group2, fill= significance)) +
geom_tile() +
scale_fill_viridis(discrete=FALSE) +
scatterplot <- topic_engagement_tbl %>%
group_by(Dominant_Topic) %>%
summarise(median_eng = median(Total_Interactions),
count = n()) %>%
ggplot(aes(x=count, y=median_eng)) +
geom_point() +
geom_text(aes(label=Dominant_Topic),hjust=2, vjust=0) +
theme_bw() +
labs(x="Number of posts", y="Median engagement")
library(hrbrthemes)
ggplot(heatmap_tbl, aes(group1, group2, fill= significance)) +
geom_tile() +
scale_fill_gradient(low="white", high="blue")
ggplot(heatmap_tbl, aes(as.factor(group1), as.factor(group2), fill= significance)) +
geom_tile() +
scale_fill_gradient(low="white", high="blue") +
scatterplot <- topic_engagement_tbl %>%
group_by(Dominant_Topic) %>%
summarise(median_eng = median(Total_Interactions),
count = n()) %>%
ggplot(aes(x=count, y=median_eng)) +
geom_point() +
geom_text(aes(label=Dominant_Topic),hjust=2, vjust=0) +
theme_bw() +
labs(x="Number of posts", y="Median engagement")
ggplot(heatmap_tbl, aes(as.factor(group1), as.factor(group2), fill= significance)) +
geom_tile() +
scale_fill_gradient(low="white", high="blue")
ggplot(heatmap_tbl, aes(as.factor(group1), as.factor(group2), fill= significance)) +
geom_tile() +
scale_fill_gradient(low="white", high="blue") +
theme_bw()
ggplot(heatmap_tbl, aes(as.factor(group1), as.factor(group2), fill= significance)) +
geom_tile() +
scale_fill_gradient(low="white", high="blue") +
theme_minimal()
ggplot(heatmap_tbl, aes(as.factor(group1), as.factor(group2), fill= significance)) +
geom_tile() +
scale_fill_gradient(low="white", high="blue") +
theme_minimal()
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_fill_gradient(low="white", high="blue") +
theme_minimal()
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_continuous(position = "right") +
scale_fill_gradient(low="white", high="blue") +
theme_minimal()
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="blue") +
theme_minimal()
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal()
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal() +
labs(x="Topic", y="Topic", title="Are the medians of the topics significantly different?")
pairwise_tbl
1.5e-2
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal() +
labs(x="Topic", y="Topic", title="Are the medians of the topics significantly different?",
fill = "significance level")
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal() +
labs(x="Topic", y="Topic", title="Are the medians of the topics significantly different?",
fill = "p-value")
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= as.factor(significance))) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal() +
labs(x="Topic", y="Topic", title="Are the median engagement values of the topics significantly different?",
fill = "p-value")
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal() +
labs(x="Topic", y="Topic", title="Are the median engagement values of the topics significantly different?",
fill = "p-value")
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal() +
labs(x="Topic", y="Topic", title="Are the median engagement values of the topics significantly different?",
fill = "p-value") +
theme(legend.position = "none")
heatmap <- ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal() +
labs(x="Topic", y="Topic", title="Are the median engagement values of the topics significantly different?",
fill = "p-value") +
theme(legend.position = "none")
ggsave(filename = "results/heatmap.pdf", device = "pdf", width = 7, height = 5, units = "in")
ggsave(filename = "results/heatmap.pdf", device = "pdf", width = 5, height = 5, units = "in")
heatmap <- ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal() +
labs(x="Topic", y="Topic", title="Are the median engagement values of the topics significantly different?",
fill = "p-value") +
theme(legend.position = "none")
ggsave(filename = "results/heatmap.pdf", device = "pdf", width = 7, height = 7, units = "in")
# knitr::opts_chunk$set(echo = FALSE)
require(gridExtra)
require(ggplot2)
require(grid)
require(png)
library(tidyverse)
my_countries <- c("Rwanda", "Botswana", "South Africa", "Germany", "Zimbabwe")
for(1 in my_countries) {
my_countries
for(1 in my_countries) { print(1)}
for(i in my_countries) {
print(i)
}
library(glue)
for(i in my_countries) { # remember the syntax? It goes like this for(loop_variable in vector) {
un_votes %>%
filter(country == i) %>%
print() # the name of the file should be the name of the country, which in each iteration, is the loop variable
}
library(tidyverse)
library(unvotes)
library(glue)
for(i in my_countries) { # remember the syntax? It goes like this for(loop_variable in vector) {
un_votes %>%
filter(country == i) %>%
print() # the name of the file should be the name of the country, which in each iteration, is the loop variable
}
library(glue)
for(i in my_countries) { # remember the syntax? It goes like this for(loop_variable in vector) {
un_votes %>%
filter(country == {i}) %>%
print() # the name of the file should be the name of the country, which in each iteration, is the loop variable
}
un_votes %>%
filter(country == {i})
un_votes %>%
filter(country == i)
for(1 in my_countries) { print(1)}
df <- read.csv("clipboard")
df
library(ggplot2)
ggplot(df) + geom_density(marks)
ggplot(df) + geom_density(x = marks)
df
ggplot(df) + geom_histogram(aes(x=marks))
library(tidyverse)
df %>%
arrange(desc(marks))
marks %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+"
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-", "C or lower")))))))
marks %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+"
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-", "C or lower")))))))
marks %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-", "C or lower")))))))
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-", "C or lower")))))))
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-", "C or lower"))))))) %>% table(grade)
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-", "C or lower"))))))) %>% count(grade)
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-",
ifelse(marks >= 54, "C+",
ifelse(marks >= 52, "C",
ifelse(marks >= 50, "C-",
ifelse(marks >= 48, "D+", "lower")))))))))) %>% count(grade)
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-",
ifelse(marks >= 54, "C+",
ifelse(marks >= 52, "C",
ifelse(marks >= 50, "C-",
ifelse(marks >= 48, "D+", "lower"))))))))))) %>% count(grade)
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-",
ifelse(marks >= 54, "C+",
ifelse(marks >= 52, "C",
ifelse(marks >= 50, "C-",
ifelse(marks >= 45, "D+", "lower"))))))))))) %>% count(grade)
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-",
ifelse(marks >= 54, "C+",
ifelse(marks >= 52, "C",
ifelse(marks >= 50, "C-",
ifelse(marks >= 40, "D+", "lower"))))))))))) %>% count(grade)
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-",
ifelse(marks >= 54, "C+",
ifelse(marks >= 50, "C",
ifelse(marks >= 45, "C-",
ifelse(marks >= 40, "D+", "lower"))))))))))) %>% count(grade)
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-",
ifelse(marks >= 54, "C+",
ifelse(marks >= 45, "C",
ifelse(marks >= 40, "C-",
ifelse(marks >= 40, "D+", "lower"))))))))))) %>% count(grade)
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-",
ifelse(marks >= 54, "C+",
ifelse(marks >= 45, "C",
ifelse(marks >= 40, "C-",
ifelse(marks >= 35, "D+", "lower"))))))))))) %>% count(grade)
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-",
ifelse(marks >= 54, "C+",
ifelse(marks >= 40, "C",
ifelse(marks >= 35, "C-",
ifelse(marks >= 30, "D+", "lower"))))))))))) %>% count(grade)
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-",
ifelse(marks >= 52, "C+",
ifelse(marks >= 40, "C",
ifelse(marks >= 35, "C-",
ifelse(marks >= 30, "D+", "lower"))))))))))) %>% count(grade)
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-",
ifelse(marks >= 50, "C+",
ifelse(marks >= 45, "C",
ifelse(marks >= 40, "C-",
ifelse(marks >= 30, "D+", "lower"))))))))))) %>% count(grade)
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-",
ifelse(marks >= 50, "C+",
ifelse(marks >= 45, "C",
ifelse(marks >= 30, "C-",
ifelse(marks >= 20, "D+", "lower"))))))))))) %>% count(grade)
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-",
ifelse(marks >= 50, "C+",
ifelse(marks >= 42, "C",
ifelse(marks >= 30, "C-",
ifelse(marks >= 20, "D+", "lower"))))))))))) %>% count(grade)
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 56, "B",
ifelse(marks >= 55, "B-",
ifelse(marks >= 45, "C+",
ifelse(marks >= 42, "C",
ifelse(marks >= 30, "C-",
ifelse(marks >= 20, "D+", "lower"))))))))))) %>% count(grade)
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 53, "B",
ifelse(marks >= 50, "B-",
ifelse(marks >= 45, "C+",
ifelse(marks >= 42, "C",
ifelse(marks >= 30, "C-",
ifelse(marks >= 20, "D+", "lower"))))))))))) %>% count(grade)
df %>%
mutate(grade = ifelse(marks == 60, "A+",
ifelse(marks >= 59, "A",
ifelse(marks >= 58, "A-",
ifelse(marks >= 57, "B+",
ifelse(marks >= 53, "B",
ifelse(marks >= 50, "B-",
ifelse(marks >= 45, "C+",
ifelse(marks >= 40, "C",
ifelse(marks >= 30, "C-",
ifelse(marks >= 20, "D+", "lower"))))))))))) %>% count(grade)
x <- c(3, 3, 7, 8, 12, 13, 17, 23, 29, 43, 56)
summary(x)
