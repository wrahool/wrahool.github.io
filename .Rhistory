mutate(Dominant_Topic = as.factor(Dominant_Topic))
engagement_distribution <- ggplot(topic_engagement_tbl, aes(x=Total_Interactions)) +
geom_density(fill = "gray") +
labs(x = "Total Interactions", y = "Density", title = "Distribution of Total Interactions") +
theme_bw()
ggsave(filename = "results/eng_dist.pdf", device = "pdf", width = 7, height = 5, units = "in")
engagement_boxplot <- ggplot(topic_engagement_tbl, aes(x=Total_Interactions, y=Dominant_Topic)) +
geom_boxplot() +
labs(x = "Total Interactions", y = "Topic", title = "Boxplot of Total Interactions by Dominant Topic") +
theme_bw()
ggsave(filename = "results/eng_boxplot_topic.pdf", device = "pdf", width = 7, height = 5, units = "in")
engagement_boxplot_zoomed <- ggplot(topic_engagement_tbl[topic_engagement_tbl$Total_Interactions < 1000, ],
aes(x=Total_Interactions, y=Dominant_Topic)) +
geom_boxplot() +
labs(x = "Total Interactions", y = "Topic",  title = "Boxplot of Total Interactions by Dominant Topic", subtitle = "Only Total Interactions < 1000") +
theme_bw()
ggsave(filename = "results/eng_boxplot_topic_2.pdf", device = "pdf", width = 7, height = 5, units = "in")
topic_lm <- lm(rescale(Total_Interactions, to = c(0,1)) ~ Dominant_Topic, data = topic_engagement_tbl)
modelsummary(list("Total Engagements" = topic_lm), stars = T)
modelsummary(list("Total Engagements" = topic_lm), stars = T,
coef_map = c("Dominant_Topic2" = "Topic 2",
"Dominant_Topic3" = "Topic 3",
"Dominant_Topic4" = "Topic 4",
"Dominant_Topic5" = "Topic 5",
"Dominant_Topic6" = "Topic 6",
"Dominant_Topic7" = "Topic 7",
"Dominant_Topic8" = "Topic 8",
"Dominant_Topic9" = "Topic 9",
"Dominant_Topic10" = "Topic 10"),
output = "results/regression.docx")
pdf(file = "results/regression_diagnostics.pdf", width = 7, height = 5)
pdf(file = "results/regression_diagnostics.pdf", width = 7, height = 5)
par(mfrow=c(2,2))
plot(topic_lm)
dev.off()
topic_engagement_tbl
pairwise.wilcox.test(topic_engagement_tbl$Total_Interactions,
topic_engagement_tbl$Dominant_Topic,
p.adjust.method = "holm",
paired = FALSE)
pairwise_wilcox_test(
topic_engagement_tbl,
Total_Interactions ~ Dominant_Topic,
p.adjust.method = "holm",
)
pairwise_wilcox_test_result_holm <- pairwise_wilcox_test(
topic_engagement_tbl,
Total_Interactions ~ Dominant_Topic,
p.adjust.method = "holm",
)
pairwise_wilcox_test_result_holm %>%
write_csv("results/wilcoxon_test_holm.csv")
topic_engagement_tbl %>%
group_by(Dominant_Topic)
topic_engagement_tbl %>%
group_by(Dominant_Topic) %>%
summarise(median_eng = median(Total_Interactions),
count = n())
topic_engagement_tbl %>%
group_by(Dominant_Topic) %>%
summarise(median_eng = median(Total_Interactions),
count = n())
topic_engagement_tbl %>%
group_by(Dominant_Topic) %>%
summarise(median_eng = median(Total_Interactions),
count = n()) %>%
ggplot() +
geom_point(aes(x=count, y=median_eng))
topic_engagement_tbl
topic_engagement_tbl %>%
group_by(Dominant_Topic) %>%
summarise(median_eng = median(Total_Interactions),
count = n()) %>%
ggplot() +
geom_point(aes(x=count, y=median_eng)) +
theme_bw()
topic_engagement_tbl %>%
group_by(Dominant_Topic) %>%
summarise(median_eng = median(Total_Interactions),
count = n()) %>%
ggplot() +
geom_point(aes(x=count, y=median_eng)) +
theme_bw() +
labs(x="Number of posts", y="Median engagement")
topic_engagement_tbl %>%
group_by(Dominant_Topic) %>%
summarise(median_eng = median(Total_Interactions),
count = n()) %>%
ggplot() +
geom_point(aes(x=count, y=median_eng)) +
geom_text(aes(label=Dominant_Topic),hjust=0, vjust=0) +
theme_bw() +
labs(x="Number of posts", y="Median engagement")
topic_engagement_tbl %>%
group_by(Dominant_Topic) %>%
summarise(median_eng = median(Total_Interactions),
count = n()) %>%
ggplot(aes(x=count, y=median_eng)) +
geom_point() +
geom_text(aes(label=Dominant_Topic),hjust=0, vjust=0) +
theme_bw() +
labs(x="Number of posts", y="Median engagement")
topic_engagement_tbl %>%
group_by(Dominant_Topic) %>%
summarise(median_eng = median(Total_Interactions),
count = n()) %>%
ggplot(aes(x=count, y=median_eng)) +
geom_point() +
geom_text(aes(label=Dominant_Topic),hjust=1, vjust=0) +
theme_bw() +
labs(x="Number of posts", y="Median engagement")
topic_engagement_tbl %>%
group_by(Dominant_Topic) %>%
summarise(median_eng = median(Total_Interactions),
count = n()) %>%
ggplot(aes(x=count, y=median_eng)) +
geom_point() +
geom_text(aes(label=Dominant_Topic),hjust=2, vjust=0) +
theme_bw() +
labs(x="Number of posts", y="Median engagement")
scatterplot <- topic_engagement_tbl %>%
group_by(Dominant_Topic) %>%
summarise(median_eng = median(Total_Interactions),
count = n()) %>%
ggplot(aes(x=count, y=median_eng)) +
geom_point() +
geom_text(aes(label=Dominant_Topic),hjust=2, vjust=0) +
theme_bw() +
labs(x="Number of posts", y="Median engagement")
ggsave(filename = "results/scatterplot.pdf", device = "pdf", width = 7, height = 5, units = "in")
setwd("C:/Users/Subhayan/Work/Comp-Vaccine-Project/")
topic_engagement_tbl <- read_csv("data/topic_engagement_clean.csv")
library(tidyverse)
library(ggridges)
library(rstatix)
library(scales)
library(ggfortify)
library(modelsummary)
setwd("C:/Users/Subhayan/Work/Comp-Vaccine-Project/")
topic_engagement_tbl <- read_csv("data/topic_engagement_clean.csv")
topic_engagement_tbl <- topic_engagement_tbl %>%
mutate(Dominant_Topic = as.factor(Dominant_Topic))
ggplot(topic_engagement_tbl, aes(x=Total_Interactions, y=Dominant_Topic)) +
geom_bar()+
theme_bw()
ggplot(topic_engagement_tbl, aes(x=Dominant_Topic, y=Total_Interactions)) +
geom_bar()+
theme_bw()
ggplot(topic_engagement_tbl, aes(x=Dominant_Topic, y=Total_Interactions)) +
geom_bar(stat = 'identity')+
theme_bw()
topic_engagement_tbl
topic_engagement_tbl %>%
mutate(Other_Reactions = Love + Wow + Haha + Sad + Angry + Care)
topic_engagement_tbl %>%
mutate(Other_Reactions = Love + Wow + Haha + Sad + Angry + Care)
topic_engagement_tbl %>%
mutate(Other_Reactions = Love + Wow + Haha + Sad + Angry + Care) %>%
select(Dominant_Topic, Likes, Comments, Shares, Other_Reactions)
topic_engagement_tbl %>%
mutate(Other_Reactions = Love + Wow + Haha + Sad + Angry + Care) %>%
mutate(check = (Other_Reactions + Comments + Likes + Shares) == Total_Interactions)
topic_engagement_tbl %>%
mutate(Other_Reactions = Love + Wow + Haha + Sad + Angry + Care) %>%
mutate(check = (Other_Reactions + Comments + Likes + Shares) == Total_Interactions) %>% pull(check) %>% table()
topic_engagement_tbl %>%
mutate(Other_Reactions = Love + Wow + Haha + Sad + Angry + Care) %>%
# mutate(check = (Other_Reactions + Comments + Likes + Shares) == Total_Interactions) %>% pull(check) %>% table()
select(Dominant_Topic, Likes, Comments, Shares, Other_Reactions)
topic_engagement_tbl %>%
mutate(Other_Reactions = Love + Wow + Haha + Sad + Angry + Care) %>%
# mutate(check = (Other_Reactions + Comments + Likes + Shares) == Total_Interactions) %>% pull(check) %>% table()
select(Dominant_Topic, Likes, Comments, Shares, Other_Reactions) %>%
pivot_longer(names_to = "Interactions_Type", values_to = "Interactions_count")
topic_engagement_tbl %>%
mutate(Other_Reactions = Love + Wow + Haha + Sad + Angry + Care) %>%
# mutate(check = (Other_Reactions + Comments + Likes + Shares) == Total_Interactions) %>% pull(check) %>% table()
select(Dominant_Topic, Likes, Comments, Shares, Other_Reactions) %>%
pivot_longer(cols = c("Likes", "Comments", "Shares", "Other_Reactions"), names_to = "Interactions_Type", values_to = "Interactions_count")
barplot_tbl <- topic_engagement_tbl %>%
mutate(Other_Reactions = Love + Wow + Haha + Sad + Angry + Care) %>%
# mutate(check = (Other_Reactions + Comments + Likes + Shares) == Total_Interactions) %>% pull(check) %>% table()
select(Dominant_Topic, Likes, Comments, Shares, Other_Reactions) %>%
pivot_longer(cols = c("Likes", "Comments", "Shares", "Other_Reactions"), names_to = "Interactions_Type", values_to = "Interactions_count")
engagement_barchart <- ggplot(topic_engagement_tbl, aes(x=Dominant_Topic, y=Interactions_Count, fill=Interactions_Type)) +
geom_bar(stat = 'identity')+
theme_bw()
engagement_barchart
barplot_tbl <- topic_engagement_tbl %>%
mutate(Other_Reactions = Love + Wow + Haha + Sad + Angry + Care) %>%
# mutate(check = (Other_Reactions + Comments + Likes + Shares) == Total_Interactions) %>% pull(check) %>% table()
select(Dominant_Topic, Likes, Comments, Shares, Other_Reactions) %>%
pivot_longer(cols = c("Likes", "Comments", "Shares", "Other_Reactions"), names_to = "Interactions_Type", values_to = "Interactions_count")
engagement_barchart <- ggplot(topic_engagement_tbl, aes(x=Dominant_Topic, y=Interactions_Count, fill=Interactions_Type)) +
geom_bar(stat = 'identity', position = 'dodge') +
theme_bw()
engagement_barchart
ggplot(barplot_tbl, aes(x=Dominant_Topic, y=Interactions_Count, fill=Interactions_Type)) +
geom_bar(stat = 'identity', position = 'dodge') +
theme_bw()
barplot_tbl <- topic_engagement_tbl %>%
mutate(Other_Reactions = Love + Wow + Haha + Sad + Angry + Care) %>%
# mutate(check = (Other_Reactions + Comments + Likes + Shares) == Total_Interactions) %>% pull(check) %>% table()
select(Dominant_Topic, Likes, Comments, Shares, Other_Reactions) %>%
pivot_longer(cols = c("Likes", "Comments", "Shares", "Other_Reactions"), names_to = "Interactions_Type", values_to = "Interactions_count")
barplot_tbl
barplot_tbl <- topic_engagement_tbl %>%
mutate(Other_Reactions = Love + Wow + Haha + Sad + Angry + Care) %>%
# mutate(check = (Other_Reactions + Comments + Likes + Shares) == Total_Interactions) %>% pull(check) %>% table()
select(Dominant_Topic, Likes, Comments, Shares, Other_Reactions) %>%
pivot_longer(cols = c("Likes", "Comments", "Shares", "Other_Reactions"), names_to = "Interactions_Type", values_to = "Interactions_Count")
engagement_barchart <- ggplot(barplot_tbl, aes(x=Dominant_Topic, y=Interactions_Count, fill=Interactions_Type)) +
geom_bar(stat = 'identity', position = 'dodge') +
theme_bw()
engagement_barchart
engagement_barchart
ggplot(barplot_tbl, aes(x=Dominant_Topic, y=Interactions_Count, fill=Interactions_Type)) +
geom_bar(stat = 'identity', position = 'dodge') +
theme_bw() +
scale_color_viridis_d()
ggplot(barplot_tbl, aes(x=Dominant_Topic, y=Interactions_Count, fill=Interactions_Type)) +
geom_bar(stat = 'identity', position = 'dodge') +
theme_bw() +
scale_colour_viridis_d()
ggplot(barplot_tbl[barplot_tbl$Interactions_Type != "Likes",], aes(x=Dominant_Topic, y=Interactions_Count, fill=Interactions_Type)) +
geom_bar(stat = 'identity', position = 'dodge') +
theme_bw() +
scale_colour_viridis_d()
ggplot(barplot_tbl[barplot_tbl$Interactions_Type != "Likes",], aes(x=Dominant_Topic, y=Interactions_Count, fill=Interactions_Type)) +
geom_bar(stat = 'identity', position = 'dodge') +
scale_fill_viridis_d() +
theme_bw()
engagement_barchart1 <- ggplot(barplot_tbl, aes(x=Dominant_Topic, y=Interactions_Count, fill=Interactions_Type)) +
geom_bar(stat = 'identity', position = 'dodge') +
scale_colour_viridis_d()
engagement_barchart1 <- ggplot(barplot_tbl, aes(x=Dominant_Topic, y=Interactions_Count, fill=Interactions_Type)) +
geom_bar(stat = 'identity', position = 'dodge') +
scale_colour_viridis_d() +
theme_bw()
engagement_barchart2 <- ggplot(barplot_tbl[barplot_tbl$Interactions_Type != "Likes",], aes(x=Dominant_Topic, y=Interactions_Count, fill=Interactions_Type)) +
geom_bar(stat = 'identity', position = 'dodge') +
scale_fill_viridis_d() +
theme_bw()
engagement_barchart1
engagement_barchart2
ggplot(barplot_tbl[barplot_tbl$Interactions_Type != "Likes",], aes(x=Dominant_Topic, y=Interactions_Count, fill=Interactions_Type)) +
geom_bar(stat = 'identity', position = 'dodge') +
scale_fill_viridis_d() +
theme_bw()
ggplot(barplot_tbl, aes(x=Dominant_Topic, y=Interactions_Count, fill=Interactions_Type)) +
geom_bar(stat = 'identity', position = 'dodge') +
scale_fill_viridis_d() +
theme_bw()
ggplot(barplot_tbl[barplot_tbl$Interactions_Type != "Likes",], aes(x=Dominant_Topic, y=Interactions_Count, fill=Interactions_Type)) +
geom_bar(stat = 'identity', position = 'dodge') +
scale_fill_viridis_d() +
theme_bw()
scale_fill_viridis_d()
barplot_tbl
barplot_tbl %>% filter(Dominant_Topic == 6)
barplot_tbl %>% filter(Dominant_Topic == 6) %>% pull(Other_Reactions) %>% sum()
barplot_tbl %>% filter(Dominant_Topic == 6, Interactions_Type == "Other_Reactions") %>% pull(Interactions_Count) %>% sum()
barplot_tbl %>% filter(Dominant_Topic == 6, Interactions_Type == "Comments") %>% pull(Interactions_Count) %>% sum()
barplot_tbl %>% filter(Dominant_Topic == 6, Interactions_Type == "Shares") %>% pull(Interactions_Count) %>% sum()
topic_engagement_tbl
topic_engagement_tbl %>%
pull(Dominant_Topic) %>%
table()
topic_engagement_tbl %>%
pull(Dominant_Topic) %>%
table() %>% sum()
topic_engagement_tbl
topic_engagement_tbl %>%
pull(Dominant_Topic) %>%
table() %>% as_tibble()
topic_engagement_tbl %>%
pull(Dominant_Topic) %>%
table() %>%
as_tibble() %>%
rename("Topic" = 1)
topic_engagement_tbl %>%
count(Dominant_Topic)
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n)
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity")
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="cyan")
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="black") +
theme_bw()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray") +
theme_bw()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray2") +
theme_bw()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray3") +
theme_bw()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray27") +
theme_bw()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray27", width = 0.1) +
theme_bw()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray27", width = 0.3) +
theme_bw()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray27", width = 0.4) +
theme_bw()
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray27", width = 0.4) +
labs(x="Topic", y="Count", title="Frequency of topics")
topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray27", width = 0.4) +
labs(x="Topic", y="Count", title="Frequency of topics") +
theme_bw()
topic_freq_tbl <- topic_engagement_tbl %>%
count(Dominant_Topic) %>%
rename("Count" = n) %>%
ggplot(aes(x=Dominant_Topic, y=Count)) +
geom_bar(stat = "identity", fill="gray27", width = 0.4) +
labs(x="Topic", y="Count", title="Frequency of topics") +
theme_bw()
ggsave(filename = "results/topic_freq.pdf", device = "pdf", width = 7, height = 5, units = "in")
pairwise_tbl <- read_csv("results/wilcoxon_test_holm.csv")
pairwise_tbl
pairwise_tbl %>% pull(p.adj.signif) %>% unique()
View(pairwise_tbl)
pairwise_tbl %>%
mutate(significance  = ifelse(p.adj.signif == "ns", 0,
ifelse(p.adj.signif == "*", 1,
ifelse(p.adj.signif == "**", 2,
ifelse(p.adj.signif == "***", 3, 4)))))
heatmap_tbl <- pairwise_tbl %>%
mutate(significance  = ifelse(p.adj.signif == "ns", 0,
ifelse(p.adj.signif == "*", 1,
ifelse(p.adj.signif == "**", 2,
ifelse(p.adj.signif == "***", 3, 4))))) %>%
select(group1, group2, significance)
heatmap_tbl
ggplot(heatmap_tbl, aes(group1, group2, fill= significance)) +
geom_tile()
ggplot(heatmap_tbl, aes(group1, group2, fill= significance)) +
geom_tile() +
scale_fill_viridis(discrete=FALSE) +
scatterplot <- topic_engagement_tbl %>%
group_by(Dominant_Topic) %>%
summarise(median_eng = median(Total_Interactions),
count = n()) %>%
ggplot(aes(x=count, y=median_eng)) +
geom_point() +
geom_text(aes(label=Dominant_Topic),hjust=2, vjust=0) +
theme_bw() +
labs(x="Number of posts", y="Median engagement")
library(hrbrthemes)
ggplot(heatmap_tbl, aes(group1, group2, fill= significance)) +
geom_tile() +
scale_fill_gradient(low="white", high="blue")
ggplot(heatmap_tbl, aes(as.factor(group1), as.factor(group2), fill= significance)) +
geom_tile() +
scale_fill_gradient(low="white", high="blue") +
scatterplot <- topic_engagement_tbl %>%
group_by(Dominant_Topic) %>%
summarise(median_eng = median(Total_Interactions),
count = n()) %>%
ggplot(aes(x=count, y=median_eng)) +
geom_point() +
geom_text(aes(label=Dominant_Topic),hjust=2, vjust=0) +
theme_bw() +
labs(x="Number of posts", y="Median engagement")
ggplot(heatmap_tbl, aes(as.factor(group1), as.factor(group2), fill= significance)) +
geom_tile() +
scale_fill_gradient(low="white", high="blue")
ggplot(heatmap_tbl, aes(as.factor(group1), as.factor(group2), fill= significance)) +
geom_tile() +
scale_fill_gradient(low="white", high="blue") +
theme_bw()
ggplot(heatmap_tbl, aes(as.factor(group1), as.factor(group2), fill= significance)) +
geom_tile() +
scale_fill_gradient(low="white", high="blue") +
theme_minimal()
ggplot(heatmap_tbl, aes(as.factor(group1), as.factor(group2), fill= significance)) +
geom_tile() +
scale_fill_gradient(low="white", high="blue") +
theme_minimal()
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_fill_gradient(low="white", high="blue") +
theme_minimal()
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_continuous(position = "right") +
scale_fill_gradient(low="white", high="blue") +
theme_minimal()
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="blue") +
theme_minimal()
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal()
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal() +
labs(x="Topic", y="Topic", title="Are the medians of the topics significantly different?")
pairwise_tbl
1.5e-2
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal() +
labs(x="Topic", y="Topic", title="Are the medians of the topics significantly different?",
fill = "significance level")
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal() +
labs(x="Topic", y="Topic", title="Are the medians of the topics significantly different?",
fill = "p-value")
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= as.factor(significance))) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal() +
labs(x="Topic", y="Topic", title="Are the median engagement values of the topics significantly different?",
fill = "p-value")
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal() +
labs(x="Topic", y="Topic", title="Are the median engagement values of the topics significantly different?",
fill = "p-value")
ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal() +
labs(x="Topic", y="Topic", title="Are the median engagement values of the topics significantly different?",
fill = "p-value") +
theme(legend.position = "none")
heatmap <- ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal() +
labs(x="Topic", y="Topic", title="Are the median engagement values of the topics significantly different?",
fill = "p-value") +
theme(legend.position = "none")
ggsave(filename = "results/heatmap.pdf", device = "pdf", width = 7, height = 5, units = "in")
ggsave(filename = "results/heatmap.pdf", device = "pdf", width = 5, height = 5, units = "in")
heatmap <- ggplot(heatmap_tbl, aes(as.factor(group2), as.factor(group1), fill= significance)) +
geom_tile() +
scale_y_discrete(position = "right") +
scale_fill_gradient(low="white", high="skyblue") +
theme_minimal() +
labs(x="Topic", y="Topic", title="Are the median engagement values of the topics significantly different?",
fill = "p-value") +
theme(legend.position = "none")
ggsave(filename = "results/heatmap.pdf", device = "pdf", width = 7, height = 7, units = "in")
